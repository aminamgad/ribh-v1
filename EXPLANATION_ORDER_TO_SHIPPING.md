# ๐ฆ ุดุฑุญ: ููู ูุนูู ุงููุธุงู ุญุงููุงู

## ๐ ุงูุณุคุงู: ูู ุงููุธุงู ูุญุชุงุฌ Token ูุฅุฑุณุงู ุงูุทูุจ ูุดุฑูุฉ ุงูุดุญูุ

**ุงูุฅุฌุงุจุฉ:** **ูุงุ ุงููุธุงู ุงูุญุงูู ูุง ูุญุชุงุฌ Token** ูุฃูู ูุง ูุณุชุฏุนู API endpoint ุฎุงุฑุฌู.

---

## ๐๏ธ ููู ูุนูู ุงููุธุงู ุญุงููุงู:

### 1๏ธโฃ **ุนูุฏ ุฅูุดุงุก Order:**

```
Order Created
    โ
createPackageFromOrder()
    โ
ุฅูุดุงุก Package ูุจุงุดุฑุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
    โ
Package ููุฌูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช โ
```

**ูุง ููุฌุฏ:**
- โ ุงุณุชุฏุนุงุก API ุฎุงุฑุฌู
- โ ุฅุฑุณุงู HTTP request
- โ ุงุณุชุฎุฏุงู Token

---

### 2๏ธโฃ **API Endpoint `/api/external_company/create-package`:**

ูุฐุง ุงูู endpoint **ููุดุฑูุฉ ุงูุฎุงุฑุฌูุฉ** ูุงุณุชุฏุนุงุฆูุ ูููุณ ูููุธุงู:

```
ุงูุดุฑูุฉ ุงูุฎุงุฑุฌูุฉ
    โ
POST /api/external_company/create-package
    โ
Authorization: Bearer <API_KEY>
    โ
ุฅูุดุงุก Package ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
```

**ูุฐุง ูุฎุชูู ุชูุงูุงู!**

---

## ๐ค ูู ูุฌุจ ุฃู ูุณุชุฏุนู ุงููุธุงู API ุงูุฎุงุต ุจุดุฑูุฉ ุงูุดุญูุ

### **ุงูุณููุงุฑูู ุงูุญุงูู (ูุง ูุญุชุงุฌ Token):**
- ุงููุธุงู ููุดุฆ Package ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุงูุดุฑูุฉ ุงูุฎุงุฑุฌูุฉ ุชูุฑุฃ Packages ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (ุฃู ุนุจุฑ API)
- **ูุง ููุฌุฏ ุงุชุตุงู ูุจุงุดุฑ**

### **ุงูุณููุงุฑูู ุงูุจุฏูู (ูุญุชุงุฌ Token):**
- ุงููุธุงู ููุดุฆ Package ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- **ุซู ูุณุชุฏุนู API endpoint ุงูุฎุงุต ุจุดุฑูุฉ ุงูุดุญู** ูุฅุนูุงููุง
- **ูุฐุง ูุญุชุงุฌ Token ู webhook URL**

---

## ๐ก ูู ุชุฑูุฏ ุฅุถุงูุฉ Webhook/API Callุ

ุฅุฐุง ููุช ุชุฑูุฏ ุฃู ุงููุธุงู ูุณุชุฏุนู API ุงูุฎุงุต ุจุดุฑูุฉ ุงูุดุญู ุนูุฏ ุฅูุดุงุก Packageุ ูููู ุฅุถุงูุฉ:

1. **ุญูู `webhookUrl` ูู ExternalCompany:**
   ```typescript
   webhookUrl: {
     type: String,
     required: false
   }
   ```

2. **ุงุณุชุฏุนุงุก Webhook ุจุนุฏ ุฅูุดุงุก Package:**
   ```typescript
   // ุจุนุฏ await newPackage.save()
   if (externalCompany.webhookUrl) {
     await fetch(externalCompany.webhookUrl, {
       method: 'POST',
       headers: {
         'Authorization': `Bearer ${externalCompany.apiKey}`,
         'Content-Type': 'application/json'
       },
       body: JSON.stringify({
         package_id: newPackage.packageId,
         order_id: order._id,
         // ... ุจูุงูุงุช ุฃุฎุฑู
       })
     });
   }
   ```

---

## โ ุงูุฎูุงุตุฉ:

**ุงููุธุงู ุงูุญุงูู:**
- โ ููุดุฆ Package ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ ูุง ูุญุชุงุฌ Token
- โ ูุง ูุณุชุฏุนู API ุฎุงุฑุฌู

**ุฅุฐุง ุฃุฑุฏุช ุฅุถุงูุฉ Webhook:**
- ูููู ุฅุถุงูุฉ ุญูู `webhookUrl` ูู ExternalCompany
- ูููู ุงุณุชุฏุนุงุก Webhook ุจุนุฏ ุฅูุดุงุก Package
- **ูุฐุง ูุญุชุงุฌ Token**

**ุงููุดููุฉ ุงูุญุงููุฉ:**
- โ ูุง ุชูุฌุฏ ุดุฑูุฉ ุดุญู ุฎุงุฑุฌูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- **ุงูุญู:** `node scripts/create-external-company.js "ุงุณู ุงูุดุฑูุฉ"`

---

**ูู ุชุฑูุฏ ุฅุถุงูุฉ Webhook/API Callุ** ุฃุฎุจุฑูู ูุณุฃุถููู! ๐

