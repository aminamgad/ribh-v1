# ๐ ุฏููู ุฅุนุฏุงุฏ ุดุฑูุฉ ุงูุดุญู - Shipping Company Setup Guide

## ๐ ูุธุฑุฉ ุนุงูุฉ

ูุฐุง ุงูุฏููู ูุดุฑุญ ููููุฉ ุฅุนุฏุงุฏ ุงููุธุงู ูุฅุฑุณุงู ุงูุทูุจุงุช ุชููุงุฆูุงู ูุดุฑูุฉ ุงูุดุญู.

---

## โ๏ธ ุงููุดููุฉ ุงูุดุงุฆุนุฉ

ุฅุฐุง ุธูุฑุช ุฑุณุงูุฉ ุงูุฎุทุฃ ุงูุชุงููุฉ ูู ุงูู logs:
```
โ [ERROR] No external company found. Please create an external company first.
โ๏ธ FAILED TO SEND ORDER TO SHIPPING COMPANY
```

ูุฐุง ูุนูู ุฃู **ูุง ุชูุฌุฏ ุดุฑูุฉ ุดุญู ุฎุงุฑุฌูุฉ** ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช. ูุฌุจ ุฅูุดุงุก ุดุฑูุฉ ุดุญู ุฃููุงู.

---

## ๐ง ุฎุทูุงุช ุงูุฅุนุฏุงุฏ

### 1๏ธโฃ ุฅูุดุงุก ุดุฑูุฉ ุดุญู ุฎุงุฑุฌูุฉ

ูู ุจุชุดุบูู ุงูู script ุงูุชุงูู:

```bash
node scripts/create-external-company.js "ุงุณู ุงูุดุฑูุฉ"
```

**ูุซุงู:**
```bash
node scripts/create-external-company.js "ุดุฑูุฉ ุงูุดุญู ุงูุณุฑูุน"
```

**ุงููุชูุฌุฉ:**
```
โ External Company Created Successfully!

๐ Company Details:
   Company Name: ุดุฑูุฉ ุงูุดุญู ุงูุณุฑูุน
   API Key: ribh_abc123...
   API Secret: xyz789...
   Active: true

โ๏ธ  IMPORTANT: Save the API Key and Secret securely!
   The API Secret will not be shown again.
```

**โ๏ธ ููู ุฌุฏุงู:** ุงุญูุธ **API Key** ู **API Secret** ูู ููุงู ุขูู. ุณุชุญุชุงุฌูู ูุงุญูุงู.

---

### 2๏ธโฃ ุชุนููู ุงูุดุฑูุฉ ุงูุงูุชุฑุงุถูุฉ (ุงุฎุชูุงุฑู)

ุจุนุฏ ุฅูุดุงุก ุงูุดุฑูุฉุ ููููู ุชุนููููุง ูุดุฑูุฉ ุงูุชุฑุงุถูุฉ ูู ุฎูุงู:

#### ุงูุทุฑููุฉ ุงูุฃููู: ูู ููุญุฉ ุงูุชุญูู (Admin Settings)

1. ุงุฐูุจ ุฅูู `/dashboard/admin/settings`
2. ุงุฎุชุฑ ุชุจููุจ **Shipping Settings**
3. ูู ุญูู **"ุดุฑูุฉ ุงูุดุญู ุงูุงูุชุฑุงุถูุฉ"**ุ ุงุฎุชุฑ ุงูุดุฑูุฉ ุงูุชู ุฃูุดุฃุชูุง
4. ูุนูู **"ุฅูุดุงุก ุทุฑูุฏ ุงูุดุญู ุชููุงุฆูุงู ุนูุฏ ุฅูุดุงุก ุงูุทูุจ"**
5. ุงุญูุธ ุงูุชุบููุฑุงุช

#### ุงูุทุฑููุฉ ุงูุซุงููุฉ: ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

ุฅุฐุง ููุช ุชุฑูุฏ ุชุนููู ุงูุดุฑูุฉ ูุจุงุดุฑุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:

```javascript
// ูู MongoDB shell ุฃู MongoDB Compass
db.systemsettings.updateOne(
  {},
  {
    $set: {
      defaultExternalCompanyId: ObjectId("YOUR_COMPANY_ID_HERE"),
      autoCreatePackages: true
    }
  },
  { upsert: true }
);
```

**ููุงุญุธุฉ:** ุฅุฐุง ูู ุชูู ุจุชุนููู ุดุฑูุฉ ุงูุชุฑุงุถูุฉุ ุงููุธุงู ุณูุณุชุฎุฏู **ุฃูู ุดุฑูุฉ ูุดุทุฉ** ุชููุงุฆูุงู.

---

### 3๏ธโฃ ุงูุชุฃูุฏ ูู ูุฌูุฏ ุจูุงูุงุช ุงููุฑู

ุชุฃูุฏ ูู ุฃู ุจูุงูุงุช ุงููุฑู ููุฌูุฏุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:

```bash
node scripts/import-villages.js
```

ูุฐุง ุงูุฃูุฑ ูุณุชูุฑุฏ ุฌููุน ุงููุฑู ูู ููู `villages (1).json` (741 ูุฑูุฉ).

---

### 4๏ธโฃ ุฅุถุงูุฉ ุฃููุงุน ุงูุทุฑูุฏ (ุงุฎุชูุงุฑู)

```bash
node scripts/seed-package-types.js
```

ูุฐุง ุงูุฃูุฑ ูุถูู ุงูุฃููุงุน ุงูุชุงููุฉ:
- `normal` - ุนุงุฏู
- `express` - ุณุฑูุน
- `fragile` - ูุด
- `heavy` - ุซููู
- `document` - ูุณุชูุฏุงุช

---

## โ ุงูุชุญูู ูู ุงูุฅุนุฏุงุฏ

ุจุนุฏ ุฅููุงู ุงูุฎุทูุงุช ุงูุณุงุจูุฉ:

1. **ุชุญูู ูู ูุฌูุฏ ุดุฑูุฉ ุดุญู:**
   - ุงุฐูุจ ุฅูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
   - ุชุญูู ูู ูุฌูุฏ `ExternalCompany` ูุงุญุฏุฉ ุนูู ุงูุฃูู ูุน `isActive: true`

2. **ุฃูุดุฆ ุทูุจ ุชุฌุฑูุจู:**
   - ุฃูุดุฆ ุทูุจ ุฌุฏูุฏ ูู ุงููุธุงู
   - ุชุฃูุฏ ูู ุฃู ุงูุทูุจ ูุญุชูู ุนูู `villageId` ูู `shippingAddress`

3. **ุชุญูู ูู ุงูู Logs:**
   - ุงุจุญุซ ุนู: `โ ORDER SENT TO SHIPPING COMPANY`
   - ุฅุฐุง ุธูุฑุช ูุฐู ุงูุฑุณุงูุฉุ ูุนูู ุฃู ุงูุทูุจ ุชู ุฅุฑุณุงูู ุจูุฌุงุญ!

---

## ๐ ููููุฉ ุงูุชุญูู ูู ูุฌุงุญ ุงูุฅุฑุณุงู

### ูู ุงูู Logs:

ุงุจุญุซ ุนู ุฅุญุฏู ุงูุฑุณุงุฆู ุงูุชุงููุฉ:

#### โ ูุฌุงุญ ุงูุฅุฑุณุงู:
```
โ ORDER SENT TO SHIPPING COMPANY - Package created from order automatically
```

**ุงููุนูููุงุช ุงููุณุฌูุฉ:**
- `orderId`: ูุนุฑู ุงูุทูุจ
- `orderNumber`: ุฑูู ุงูุทูุจ
- `packageId`: ุฑูู ุงูุทุฑุฏ ุงูุฐู ุชู ุฅูุดุงุคู
- `externalCompanyName`: ุงุณู ุดุฑูุฉ ุงูุดุญู
- `barcode`: ุงูุจุงุฑููุฏ ุงูุฎุงุต ุจุงูุทุฑุฏ
- `villageId`: ูุนุฑู ุงููุฑูุฉ
- `villageName`: ุงุณู ุงููุฑูุฉ
- `timestamp`: ููุช ุงูุฅุฑุณุงู

#### โ๏ธ ูุดู ุงูุฅุฑุณุงู:
```
โ๏ธ FAILED TO SEND ORDER TO SHIPPING COMPANY
```

**ุงูุฃุณุจุงุจ ุงูุดุงุฆุนุฉ:**
- ูุง ุชูุฌุฏ ุดุฑูุฉ ุดุญู ุฎุงุฑุฌูุฉ ูุดุทุฉ
- ุงูุทูุจ ูุง ูุญุชูู ุนูู `villageId` ูู `shippingAddress`
- ุงููุฑูุฉ ุบูุฑ ููุฌูุฏุฉ ุฃู ุบูุฑ ูุดุทุฉ

---

## ๐ก API Endpoint ููุดุฑูุฉ ุงูุฎุงุฑุฌูุฉ

ุงูุดุฑูุฉ ุงูุฎุงุฑุฌูุฉ ูููููุง ุฃูุถุงู ุฅูุดุงุก Packages ูุจุงุดุฑุฉ ุนุจุฑ API:

**Endpoint:** `POST /api/external_company/create-package`

**Headers:**
```
Authorization: Bearer <API_KEY>
Content-Type: application/json
```

**Request Body:**
```json
{
    "to_name": "ุฃุญูุฏ ูุญูุฏ ุนูู",
    "to_phone": "01234567890",
    "alter_phone": "09876543210",
    "description": "ุฌูุงุฒ ุฅููุชุฑููู",
    "package_type": "normal",
    "village_id": "1",
    "street": "ุดุงุฑุน ุงููุตุฑ",
    "total_cost": "200",
    "note": "ููุงุญุธุงุช ุฅุถุงููุฉ",
    "barcode": "PKG-2024-001234"
}
```

**Success Response (201 Created):**
```json
{
    "code": 200,
    "state": "success",
    "data": {
        "package_id": 1234
    },
    "message": "Operation Successful"
}
```

---

## ๐ฏ ููุฎุต

1. โ **ุฅูุดุงุก ุดุฑูุฉ ุดุญู:** `node scripts/create-external-company.js "ุงุณู ุงูุดุฑูุฉ"`
2. โ **ุชุนููู ุงูุดุฑูุฉ ุงูุงูุชุฑุงุถูุฉ:** ูู Admin Settings ุฃู ูุงุนุฏุฉ ุงูุจูุงูุงุช
3. โ **ุชูุนูู ุงูุฅูุดุงุก ุงูุชููุงุฆู:** `autoCreatePackages: true` ูู Settings
4. โ **ุงูุชุญูู ูู ุงูุจูุงูุงุช:** ุชุฃูุฏ ูู ูุฌูุฏ ุงููุฑู ูุฃููุงุน ุงูุทุฑูุฏ
5. โ **ุงุฎุชุจุงุฑ ุงููุธุงู:** ุฃูุดุฆ ุทูุจ ุชุฌุฑูุจู ูุชุญูู ูู ุงูู logs

---

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:
1. ุชุญูู ูู ุงูู logs ููุจุญุซ ุนู ุฑุณุงุฆู ุงูุฎุทุฃ
2. ุชุฃูุฏ ูู ุฃู ุฌููุน ุงูุฎุทูุงุช ุชู ุฅููุงููุง ุจุดูู ุตุญูุญ
3. ุชุญูู ูู ุฃู ุงูุดุฑูุฉ ุงูุฎุงุฑุฌูุฉ `isActive: true`
4. ุชุฃูุฏ ูู ุฃู ุงูุทูุจ ูุญุชูู ุนูู `villageId` ุตุญูุญ ูู `shippingAddress`

---

**ุชู ุงูุชุญุฏูุซ:** 2025-12-02

